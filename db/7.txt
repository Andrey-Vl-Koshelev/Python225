Таблица Salespeople :
snum - номер продавца (первичный ключ)
sname - имя продавца
com - комиссионные продавца
city - город проживания продавца
Таблица Orders :
onum - номер заказа (первичный ключ)
snum - номер продавца
cnum - номер заказчика
amt - сумма заказа
odate - дата заказа
Таблица Customers :
cnum - номер заказчика (первичный ключ)
cname – имя заказчика (клиента)
city - город проживания заказчика
snum - номер продавца
rating - рейтинг
1 Напишите запрос, который выведет тех заказчиков в городах, которых не проживают продавцы.
2 Напишите запрос, который выбрал бы высший рейтинг в каждом городе.
SELECT city,MAX(rating)
FROM Customers
SELECT city,MAX(rating)
FROM Customers
GROUP BY city
3 Подсчитать, на какую сумму было продано товаров в каждый город.DASC
SELECT c.city,SUM(o.amt)
FROM Customers c, Orders o
WHERE o.cnum=c.cnum
GROUP BY c.city
4 Определить сколько продавцов проживает в каждом городе.
5 Выведите максимальный рейтинг заказчика для каждого продавца.
6 Напишите запрос, который получит максимальную сумму заказов каждого клиента, которая больше
3000
SELECT o.snum, MAX(o.amt)
FROM Orders o
GROUP BY o.snum
HAVING MAX(o.amt) > 3000
7 Напишите запрос, который из таблицы заказов найдет минимальную сумму для каждой даты заказа,
отсортировав по убыванию даты.
SELECT o.odate, MIN(o.amt)
FROM Orders o
GROUP BY o.odate
ORDER BY o.odate DESC
8 Выведите максимальную сумму заказа для каждого покупателя. Вывести и фамилии покупателей.
SELECT c.cname, MAX(o.amt)
FROM Orders o, Customers c
WHERE o.cnum=c.cnum
GROUP BY c.cname
9 Напишите запрос к таблице Заказчиков, который мог бы найти высший рейтинг в каждом городе.
Вывод должен быть в такой форме: For the city (city), the highest rating is: (rating).
10 Определите общую сумму заказа для каждого дня.
11 Напишите запрос, который выведет сумму продаж, которая больше 10000
SELECT c.city,SUM(o.amt)
FROM Customers c, Orders o
WHERE o.cnum=c.cnum
GROUP BY c.city
HAVING SUM(o.amt) > 10000
12 Выведите фамилию и общую сумму заказа для каждого продавца.
13 Выведите сумму товара и фамилию заказчика, сгруппировав товар по фамилиям.